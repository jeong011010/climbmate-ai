# 🧗‍♀️ ClimbMate - AI 클라이밍 문제 분석

> 볼더링 벽 사진만 찍으면 AI가 홀드를 감지하고, 문제를 분류하고, 난이도와 유형을 분석합니다.

## 📌 **현재 상태 (체크포인트: 5f79dda)**

**✅ 모든 핵심 기능이 완벽하게 동작하는 안정적인 상태**

### 🏗️ **현재 아키텍처**
```
브라우저: 이미지 업로드 + 진행률 표시
    ↓
서버: 작업 큐 관리 (FastAPI + Celery)
    ↓
Celery Worker: YOLO + CLIP + GPT-4 분석
    ↓
결과 반환 (비동기 폴링)
```

### ✅ **완벽 동작하는 기능들**
- **YOLO 홀드 감지**: 정확한 홀드 위치 및 크기 감지
- **CLIP 색상 분석**: AI 기반 정확한 색상 분류
- **GPT-4 문제 생성**: 한국어로 상세한 문제 분석
- **비동기 처리**: Celery + Redis로 안정적인 백그라운드 처리
- **실시간 진행률**: 폴링 방식으로 사용자에게 진행 상황 표시
- **데이터베이스**: SQLite로 분석 결과 및 피드백 저장
- **완전한 프론트엔드**: React로 완전한 UI 구현

### ⚠️ **현재 제약사항**
- **메모리 사용량**: 서버 메모리 1.9GB < 필요한 메모리 2GB
- **Celery Worker 크래시**: 메모리 부족으로 인한 SIGKILL 오류 발생 가능
- **모든 AI 모델이 서버에서 실행**: 브라우저 오프로딩 없음

### 🎯 **이 체크포인트의 의미**
- 모든 핵심 기능이 완벽하게 구현된 상태
- 서버 메모리만 충분하다면 완벽하게 동작
- 브라우저 오프로딩 시도 전의 안정적인 베이스라인
- 향후 최적화 작업의 기준점

---

## ✨ 주요 기능

### 📸 이미지 분석
- **홀드 자동 감지**: YOLOv8-seg 기반 정확한 홀드 감지
- **색상 인식**: CLIP AI 기반 정확한 색상 분류 (10가지 색상 지원)
- **문제 그룹화**: 같은 색상 홀드끼리 자동 그룹화 (최소 3개 홀드 이상)

### 🎯 난이도 & 유형 분석
- **GPT-4 Vision 통합**: 한국어 분석 결과 제공
- **실시간 진행률**: 세분화된 분석 단계 표시 (0% → 10% → 30% → 50% → 70% → 95% → 100%)
- **다중 문제 분석**: 색상별로 여러 문제 동시 분석

### 📊 분석 결과
- **난이도**: V0-V10 등급 시스템
- **유형**: dynamic, static, crimp, sloper, balance 등
- **상세 분석**: 홀드 간격, 크기, 배치 기반 기술적 분석
- **실용적 팁**: 코어 활용, 모멘텀 사용 등 구체적 조언

---

## 🚀 빠른 시작

### 요구사항
- Python 3.10+
- Node.js 18+
- (선택) OpenAI API 키

### 설치 및 실행

```bash
# 1. 저장소 클론
git clone <repository>
cd climbmate

# 2. Python 가상환경 (권장)
python3 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 3. 의존성 설치
pip install -r requirements.txt
cd frontend && npm install && cd ..

# 4. 실행
./start.sh
```

**접속:**
- 프론트엔드: http://localhost:3000
- 백엔드 API: http://localhost:8000
- API 문서: http://localhost:8000/docs

---

## 🎯 분석 과정

### 1단계: 홀드 감지 (10%)
- YOLOv8-seg 모델로 홀드 자동 감지
- 바운딩 박스와 마스크 생성

### 2단계: 색상 분석 (30%)
- CLIP AI로 각 홀드의 색상 분류
- 10가지 색상 자동 인식 (red, blue, green, yellow, purple, pink, gray, brown, white, black)

### 3단계: 문제 생성 (50%)
- 같은 색상 홀드끼리 그룹화
- 최소 3개 홀드 이상인 그룹만 문제로 인식

### 4단계: GPT-4 분석 (70-95%)
- 각 문제별로 GPT-4 Vision API 호출
- 한국어로 난이도, 유형, 분석, 팁 제공
- 실시간 진행률 표시 (1/7, 2/7, ...)

### 5단계: 완료 (100%)
- 모든 분석 결과 통합
- 프론트엔드에 결과 전달

---

## 📱 모바일 PWA

### 설치 방법
1. 모바일 브라우저에서 접속
2. "홈 화면에 추가" 클릭
3. 앱처럼 사용!

### 기능
- ✅ 오프라인 캐싱
- ✅ 카메라 직접 촬영
- ✅ 바텀시트 UI
- ✅ 터치 최적화

---

## 🛠️ 기술 스택

### 백엔드 (서버 사이드)
- **FastAPI**: Python 웹 프레임워크
- **Celery**: 비동기 작업 큐 (Redis 브로커)
- **YOLOv8-seg**: 홀드 감지 모델 (~500MB)
- **CLIP ViT-B/32**: 색상 분석 AI (~1.5GB)
- **GPT-4 Vision**: 문제 생성 AI (API 호출)
- **SQLite**: 분석 결과 및 피드백 저장

### 프론트엔드 (브라우저)
- **React**: JavaScript 프레임워크
- **Vite**: 빌드 도구
- **Tailwind CSS**: 스타일링
- **PWA**: 모바일 앱 지원

### 인프라
- **Docker Compose**: 컨테이너 오케스트레이션
- **Nginx**: 리버스 프록시
- **AWS Lightsail**: 클라우드 호스팅 (1.9GB RAM)
- **Let's Encrypt**: SSL 인증서

### 메모리 사용량
- **서버 총 메모리**: ~2GB (YOLO + CLIP + Python)
- **서버 한계**: 1.9GB (메모리 부족 문제 발생)
- **브라우저**: ~150MB (React + 이미지 처리)
- Cross-validation

---

## 📊 API 엔드포인트

### POST /api/analyze
이미지 분석 (홀드 감지 + 난이도/유형)

### POST /api/feedback
사용자 피드백 저장

### POST /api/train
자체 모델 학습 (50+ 데이터 필요)

### GET /api/stats
통계 및 모델 성능 조회

---

## 🎯 로드맵

### ✅ 완료된 기능
- [x] YOLO 기반 홀드 감지
- [x] CLIP AI 색상 분류 (10가지 색상)
- [x] GPT-4 Vision 통합 (한국어 응답)
- [x] 실시간 진행률 표시
- [x] 다중 문제 동시 분석
- [x] 색상별 문제 그룹화
- [x] PWA 모바일 최적화
- [x] Celery 비동기 작업 큐
- [x] Redis 캐시 시스템

### 🚧 개발 예정
- [ ] 벽 각도 자동 감지
- [ ] 홀드 타입 세부 분류 (crimp, sloper, jug 등)
- [ ] 사용자 피드백 시스템
- [ ] 자체 ML 모델 학습
- [ ] 실시간 협업 기능

---

## 🤝 기여

피드백과 개선 제안을 환영합니다!

---

## 📄 라이선스

MIT License

---

**Made with ❤️ for climbers**

